# Задание 1. Анализ и планирование

В рамках задания было изучено текущее состояние проекта, проведен анализ и планирование.

Монолит приложения находится в папке smart-home-monolith. Там же и описана стурктура проекта в Readme.md. 

## Монолит имеет следующие REST API запросы:
1) GET /api/heating/{id} - получение данных о системе отопления по id
2) POST /api/heating/{id}/turn-on - включение системы отопления по id
3) POST /api/heating/{id}/turn-off - выключение системы отопления по id
4) POST /api/heating/{id}/set-temperature - установка температуры системы отопления по id
5) GET /api/heating/{id}/current-temperature - получение текущей температуры системы отопления по id
6) PUT /api/heating/{id} - обновление данных о системе отопления по id

Текущая система работает со следующим состоянием:
```
    private Long id; - id системы отопления
    private boolean isOn; - включена ли система отопления
    private double targetTemperature; - целевая температура
    private double currentTemperature; - текущая температура
```

## Про базу данных:
1) В проекте используется PostgreSQL.
2) В используются следующие таблицы:
    - heating_systems - таблица с данными о системах отопления
    - temperature_sensors - таблица с данными о датчиках температуры (по сути реализация паттерна event_sourcing)
    

## В рамках проекта по DDD были выделены следующие доменты и контексты для проработки:

1. Домен “Управление Устройствами”
Граница контекста: Все устройства (датчики, реле, освещение, ворота и т.д.), которые могут быть подключены к экосистеме.
Функции:
Регистрация и управление устройствами.
Возможность добавления/удаления/настройки устройств пользователем.
Поддержка стандартных протоколов для интеграции с устройствами партнёров.
Обработка событий и управление сценариями работы.


2. Домен “Мониторинг и Телеметрия”
Граница контекста: Сбор и представление данных о состояниях устройств.
Функции:
Получение и хранение данных о состоянии (например, температура, уровень освещения).
Визуализация данных для пользователя.
Управление уведомлениями о состоянии и аномалиях.

3. Домен “Управление Операциями”
Граница контекста: Логика выполнения операций и взаимодействия между устройствами.
Функции:
Обработка команд от пользователей для изменения состояния устройств.
Обработка сценариев и автоматизация действий, основанных на условиях.
Очередь команд и управление их выполнением.

4. Домен “Управление Пользователями”
Граница контекста: Взаимодействие с пользователями и их аутентификация.
Функции:
Регистрация и аутентификация пользователей.
Управление профилями пользователей и их правами доступа.
Настройка предпочтений пользователей для управления их устройствами.

5. Домен “Обслуживание клиентов”
Граница контекста: Обеспечение поддержки и обслуживания пользователей системы.
Функции:
Обработка запросов и обращений пользователей по поддержке.
Обучение пользователей по подключению и настройке устройств.
Сбор и анализ обратной связи от пользователей.

6. Домен “Аналитика и Отчётность”
Граница контекста: Сбор статистики и анализ использования системы.
Функции:
Генерация отчетов о использовании устройств и системы.
Анализ данных для выявления трендов и улучшений в системе.
Повышение качества обслуживания и предложения новых функций на основе данных.

7. Домен “Управление Сценариями”
Граница контекста: Логика пользовательских сценариев и автоматизации.
Функции:
Создание, редактирование и удаление пользовательских сценариев.
Динамическое изменение сценариев на основе данных и условий.
Взаимодействие с другими доменами (например, “Управление Устройствами” и “Управление Операциями”).


## Анализ текущей архитектуры монолитного приложения:
Текущий код является не целевым приложением, так как в нём отсутствует работа с пользователями, регистрация их устройств.
Текущий проект позволяет работать только с температурой устройства по id и сбором данных о температуре.

С точки зрения текущий архитектуры есть следующие проблемы:
1) Отсутсвует RateLimiter, что может привести к перегрузке сервера.
2) Отсутсвует обработка ошибок / исключений.
3) Все методы в контроллерах не имеют аннотации @Transactional, что может привести к несогласованности данных в БД, хотя на данный момент это и не важно.
4) Отсутсвует логирование дейсвий пользователя.
5) Отсутствует возможность масштабироваться: все запросы обрабатываются на одном сервере и синхронно, что говорит о том, что при большом количестве запросов сервер может не справиться. Нужен брокер сообщений для записи данных в БД о работе датчиков.
6) Нет единой точки входа, как API GATEWAY или NGINX.

## Визуализируйте контекст системы.
Текущий контекст системы представлен в виде отдельного файла C4_context.puml на текущем уровне директории.




